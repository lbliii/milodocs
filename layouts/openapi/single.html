{{- define "top-bar" -}}
  {{- partial "navigation/topbar/main.html" . -}}
{{- end -}}

{{- define "sidebar-left" -}}
  {{- partial "navigation/sidebar-left.html" . -}}
{{- end -}}

{{- define "content" -}}
{{- $apiData := .Params.api_data -}}
{{- $currentMethod := .Params.endpoint.method -}}
{{- $currentPath := .Params.endpoint.path -}}
{{- $currentTag := .Params.endpoint.tag -}}
{{- $operationId := .Params.endpoint.operationId -}}
{{- $operation := .Params.endpoint.operation -}}

{{- if not $apiData -}}
  <div class="error-message">
    <h2>API Data Not Found</h2>
    <p>Could not load API data from page front matter.</p>
  </div>
  {{ return }}
{{- end -}}

{{/* Generate metadata and data attributes */}}
{{ $metadata := partial "openapi/single/metadata.html" (dict 
    "operation" $operation 
    "currentMethod" $currentMethod 
    "currentPath" $currentPath 
    "operationId" $operationId) }}

<article id="articleContent"
         class="article-content {{ $metadata.articleData.class }}"
         data-component="{{ $metadata.articleData.dataComponent }}"
         data-viewer-type="{{ $metadata.articleData.dataViewerType }}"
         data-method="{{ $metadata.articleData.dataMethod }}"
         data-has-parameters="{{ $metadata.articleData.dataHasParameters }}"
         data-has-request-body="{{ $metadata.articleData.dataHasRequestBody }}"
         data-has-responses="{{ $metadata.articleData.dataHasResponses }}"
         data-has-security="{{ $metadata.articleData.dataHasSecurity }}"
         data-parameter-count="{{ $metadata.articleData.dataParameterCount }}"
         data-response-count="{{ $metadata.articleData.dataResponseCount }}"
         data-has-summary="{{ $metadata.articleData.dataHasSummary }}"
         data-has-description="{{ $metadata.articleData.dataHasDescription }}">
  
  <!-- Endpoint Header -->
  {{ partial "openapi/single/header.html" (dict 
      "operation" $operation
      "currentMethod" $currentMethod 
      "currentPath" $currentPath 
      "currentTag" $currentTag 
      "apiData" $apiData 
      "page" .) }}
  
  <!-- Endpoint Content -->
  <div class="api-endpoint-content">
    <div class="endpoint-item" 
         id="{{ $metadata.endpointData.id }}"
         data-component="{{ $metadata.endpointData.dataComponent }}"
         data-method="{{ $metadata.endpointData.dataMethod }}"
         data-path="{{ $metadata.endpointData.dataPath }}"
         data-operation-id="{{ $metadata.endpointData.dataOperationId }}"
         data-has-parameters="{{ $metadata.endpointData.dataHasParameters }}"
         data-has-request-body="{{ $metadata.endpointData.dataHasRequestBody }}"
         data-has-responses="{{ $metadata.endpointData.dataHasResponses }}"
         data-has-security="{{ $metadata.endpointData.dataHasSecurity }}"
         data-has-examples="{{ $metadata.endpointData.dataHasExamples }}">
      
      {{ partial "openapi/single/content.html" (dict 
          "operation" $operation
          "currentMethod" $currentMethod 
          "currentPath" $currentPath 
          "apiData" $apiData 
          "endpointId" $metadata.endpointId) }}
    </div>
  </div>

</article>
{{- end -}}

{{- define "sidebar-right" -}}
  {{- partial "navigation/sidebar-right.html" . -}}
{{- end -}}