{{- define "top-bar" -}}
  {{- partial "navigation/topbar/main.html" . -}}
{{- end -}}

{{- define "sidebar-left" -}}
  {{- partial "navigation/openapi-sidebar.html" . -}}
{{- end -}}

{{- define "content" -}}
<article id="articleContent" 
         class="openapi-spec"
         data-component="openapi-viewer">
  
  {{- $apiPath := .Params.api_spec -}}
  {{- $apiKeyName := replace (replace $apiPath ".yaml" "") ".yml" "" -}}
  {{- $apiData := index .Site.Data $apiKeyName -}}
  
  {{- if not $apiData -}}
    {{- warnf "OpenAPI spec not found: %s" $apiPath -}}
    <div class="error-message">
      <h2>OpenAPI Specification Not Found</h2>
      <p>Could not load API spec: <code>{{ $apiPath }}</code></p>
      <p>Please check that the file exists in the <code>data/</code> directory.</p>
    </div>
    {{ return }}
  {{- end -}}

  <!-- API Header -->
  {{ partial "openapi/header.html" (dict "spec" $apiData "page" .) }}
  
  <!-- Main API Content -->
  <div class="openapi-content">
    
    <!-- Overview Section -->
    {{ with $apiData.info }}
      {{ partial "openapi/overview.html" (dict "info" . "page" $.Page) }}
    {{ end }}
    
    <!-- Server Information -->
    {{ with $apiData.servers }}
      {{ partial "openapi/servers.html" (dict "servers" . "page" $.Page) }}
    {{ end }}
    
    <!-- Paths/Endpoints Section -->
    {{ with $apiData.paths }}
      {{ partial "openapi/endpoints.html" (dict "paths" . "spec" $apiData "page" $.Page) }}
    {{ end }}
    
    <!-- Components Section -->
    {{ with $apiData.components }}
      {{ partial "openapi/components.html" (dict "components" . "page" $.Page) }}
    {{ end }}
    
    <!-- Security Section -->
    {{ with $apiData.security }}
      {{ partial "openapi/security.html" (dict "security" . "components" $apiData.components "page" $.Page) }}
    {{ end }}
  </div>
  
  <!-- API Metadata for JavaScript -->
  <script type="application/json" id="openapi-metadata">
  {
    "title": {{ $apiData.info.title | jsonify }},
    "version": {{ $apiData.info.version | jsonify }},
    "totalPaths": {{ if $apiData.paths }}{{ len $apiData.paths }}{{ else }}0{{ end }},
    "hasComponents": {{ if $apiData.components }}true{{ else }}false{{ end }},
    "hasSecurity": {{ if $apiData.security }}true{{ else }}false{{ end }}
  }
  </script>

</article>
{{- end -}}

{{- define "sidebar-right" -}}
  {{- partial "navigation/sidebar-right.html" . -}}
{{- end -}}