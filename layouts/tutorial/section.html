{{- define "top-bar" -}}
  {{- partial "navigation/topbar/main.html" . -}}
{{- end -}}

{{- define "breadcrumbs" -}}
  <div class="my-4">
      {{partial "navigation/breadcrumbs.html" . }}
  </div>
{{- end -}}

{{- define "sidebar-left" -}}
  {{- partial "navigation/sidebar-left.html" . -}}
{{- end -}}

{{- define "content" -}}
{{$stepCount := 0}}
{{$totalSteps := len .Pages}}
{{$userProgress := 0}} {{/* This would come from user data in production */}}
{{$completedSteps := 0}} {{/* This would come from user data in production */}}

    <!-- Enhanced Hero Section -->
    <div class="tutorial-overview-hero">
        <div class="max-w-4xl mx-auto text-center p-8">
            {{/* Only show frontmatter title if content doesn't start with H1 */}}
            {{- $rawContent := .RawContent -}}
            {{- $startsWithH1 := hasPrefix (strings.TrimSpace $rawContent) "# " -}}
            {{- if not $startsWithH1 -}}
                <h1 class="text-4xl lg:text-5xl font-black text-text-primary mb-6">{{.Title}}</h1>
            {{- end -}}
            <p class="text-xl text-text-primary/80 mb-6 max-w-3xl mx-auto leading-relaxed">{{.Description}}</p>
            
            <!-- Tutorial Overview Stats -->
            <div class="flex flex-wrap justify-center gap-6 mb-8">
                <div class="tutorial-badge tutorial-badge--time">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12zm-1-9v4l3 2 1-1.5L11 9V7H9z"/>
                    </svg>
                    {{with .Params.estimatedDuration}}{{.}}{{else}}45 minutes{{end}}
                </div>
                <div class="tutorial-badge tutorial-badge--difficulty">
                    {{with .Params.difficulty}}{{.}}{{else}}Intermediate{{end}}
                </div>
                {{with .Params.prerequisites}}
                <div class="tutorial-badge tutorial-badge--prerequisites">
                    Prerequisites Required
                </div>
                {{end}}
            </div>
        </div>
    </div>

    <!-- Enhanced Tutorial Cards -->
    <div class="tutorial-overview">
        {{- range $index, $page := .Pages -}}
        {{- $stepNumber := add $index 1 -}}
        {{- $isCompleted := false -}} {{/* Would check user progress */}}
        {{- $isStarted := false -}} {{/* Would check user progress */}}
        
        <div class="tutorial-card" data-step="{{$stepNumber}}" data-difficulty="{{with $page.Params.difficulty}}{{.}}{{else}}intermediate{{end}}">
            <div class="tutorial-card__header">
                <div class="tutorial-card__badges">
                    <span class="tutorial-badge tutorial-badge--difficulty">
                        Step {{$stepNumber}}
                    </span>
                    {{with $page.Params.estimatedTime}}
                    <span class="tutorial-badge tutorial-badge--time">
                        <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12zm-1-9v4l3 2 1-1.5L11 9V7H9z"/>
                        </svg>
                        {{.}} min
                    </span>
                    {{end}}
                </div>
            </div>
            
            <h3 class="tutorial-card__title">
                {{with $page.Params.stepTitle}}{{.}}{{else}}{{$page.Title}}{{end}}
            </h3>
            
            <p class="tutorial-card__description">
                {{with $page.Params.stepDescription}}{{.}}{{else}}{{$page.Description}}{{end}}
            </p>
            
            <div class="tutorial-card__metadata">
                <!-- Progress indicator for this step -->
                <div class="tutorial-progress-mini">
                    <div class="progress-bar-mini">
                        <div class="progress-bar-mini__fill" style="width: {{if $isCompleted}}100{{else if $isStarted}}50{{else}}0{{end}}%"></div>
                    </div>
                    <span class="progress-text">
                        {{if $isCompleted}}
                            Completed
                        {{else if $isStarted}}
                            In Progress
                        {{else}}
                            Not Started
                        {{end}}
                    </span>
                </div>
                
                <!-- Tutorial actions -->
                <div class="tutorial-actions">
                    <div class="tutorial-actions__primary">
                        <a href="{{$page.RelPermalink}}" class="btn {{if $isCompleted}}btn--secondary{{else}}btn--primary{{end}}">
                            {{if $isCompleted}}
                                <svg class="btn__icon" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Review
                            {{else if $isStarted}}
                                Resume
                            {{else}}
                                Start
                            {{end}}
                        </a>
                    </div>
                    
                    <div class="tutorial-actions__secondary">
                        <button class="btn btn--ghost bookmark-tutorial" data-tutorial-id="{{$.File.BaseFileName}}-{{$stepNumber}}" title="Bookmark this step">
                            <svg class="bookmark-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        {{- end -}}
    </div>
    
    <!-- Tutorial Content -->
    <div class="max-w-4xl mx-auto p-8">
        {{ .Content }}
    </div>
    
    <!-- Prerequisites Section (if any) -->
    {{with .Params.prerequisites}}
    <div class="step-validation max-w-4xl mx-auto">
        <div class="validation-checklist">
            <h4>Before starting this tutorial, ensure you have:</h4>
            {{range .}}
            <label class="validation-item">
                <input type="checkbox" class="validation-checkbox">
                <span class="validation-text">{{.}}</span>
            </label>
            {{end}}
        </div>
        <button class="btn btn--primary validate-step" disabled data-action="start-tutorial">
            Start Tutorial
        </button>
    </div>
    {{end}}
{{- end -}}

{{- define "sidebar-right" -}}
  {{- partial "navigation/sidebar-right.html" . -}}
{{- end -}}

{{- define "innerFooter" -}}
{{- end -}}
